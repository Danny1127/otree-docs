.. _v0.5


Version 0.5
===========

What's new
----------

oTree 0.5 has a different architecture based on push and WebSockets,
through use of `Django Channels <https://github.com/andrewgodwin/channels>`__.

It should run faster and support more concurrent players.

There is also a feature called "Rooms" that aims to replace the "Default session" feature,
but that is still under development and not ready yet.

Installation
------------

To install, run this (note the ``--pre`` in the command)::

    pip install --upgrade --pre otree-core
    otree resetdb

A new pre-release is published frequently,
so it's good to run the above commands every few days,
to get the latest bugfixes.

Install Redis
~~~~~~~~~~~~~

You also need to install Redis server and run it on its default port (6379).

- Windows: download and run the `MSI <https://github.com/MSOpenTech/redis/releases>`__.
- Mac: if using Homebrew, you can follow the instructions here: `here <http://richardsumilang.com/server/redis/install-redis-on-os-x/>`__.
- Ubuntu: download `here <https://launchpad.net/~chris-lea/+archive/ubuntu/redis-server>`__.

You can test if Redis is running as follows:

.. code-block:: python

    >>> import redis
    >>> r = redis.Redis()
    >>> r.ping()

Deploying to Heroku
-------------------

You need to install Heroku's `Redis add-on <https://elements.heroku.com/addons/heroku-redis>`__.

Then update your ``requirements_base.txt`` so it contains the right version of ``otree-core``.
This will tell Heroku which version of oTree to install.
(The currently installed version of ``otree-core`` is listed in the output of ``pip freeze``).

In your project's root directory, find the file ``Procfile``
change its contents to the following, and turn on both dynos:

.. code-block:: bash

    web: otree webandworkers
    timeoutworker: otree timeoutworker


Downgrading back to oTree 0.4
-----------------------------

.. code-block:: bash

    pip uninstall otree-core
    pip install otree-core